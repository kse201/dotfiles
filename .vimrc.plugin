"============================================================
"                  *** .vimrc.plugin ***                    |
"============================================================

augroup MyAutoCmd
    autocmd!
augroup END

" dein.vim{{{
set nocompatible
filetype plugin indent off
let g:bundle_dir = $VIMFILE_DIR.'/dein/'
if has('vim_starting')
    if !isdirectory(expand(g:bundle_dir.'repos/github.com/Shougo/dein.vim/'))
        echo 'install dein.vim...'
        :call system('git clone git://github.com/Shougo/dein.vim ~/.vim/dein/repos/github.com/Shougo/dein.vim')
    endif
    exe 'set rtp+='.g:bundle_dir.'repos/github.com/Shougo/dein.vim/'
endif
call dein#begin(g:bundle_dir)
unlet g:bundle_dir

call dein#add('Shougo/dein.vim')
" unite {{{
call dein#add('Shougo/unite.vim')
call dein#add('Shougo/neomru.vim')
" }}}
" align {{{
call dein#add('h1mesuke/vim-alignta')
call dein#add('The-NERD-Commenter')
" }}}
" feature {{{
call dein#add('itchyny/lightline.vim')
call dein#add('glidenote/memolist.vim')
call dein#add('kana/vim-smartinput')
call dein#add('vim-scripts/scratch-utility')
" }}}
" colorscheme & syntax {{{
call dein#add('mrk21/yaml-vim')
call dein#add('cocopon/iceberg.vim')
call dein#add('tomasr/molokai')
" }}}
call dein#add('fatih/vim-go', {'autoload': {'filetypes': ['go']}})

call dein#add('pangloss/vim-javascript', {'autoload': {'filetypes': ['javascript']}})
call dein#add('jelera/vim-javascript-syntax', {'autoload': {'filetypes': ['javascript']}})

call dein#add('kchmck/vim-coffee-script', {'autoload': {'filetypes': ['coffee']}})
call dein#add('moll/vim-node', {'autoload': {'filetypes': ['coffee']}})
call dein#add('heavenshell/vim-jsdoc', {'autoload': {'filetypes': ['javascript', 'coffee']}})

let g:loaded_matchparen = 1

call dein#end()
filetype plugin indent on
syntax on

" install plugins
if dein#check_install()
    call dein#install()
endif

call map(dein#check_clean(), "delete(v:val, 'rf')")
" }}}

colorscheme iceberg

" unite.vim{{{
let g:unite_split_rule                      = 'botright'
let g:unite_source_file_mru_filename_format = ''
let g:unite_enable_start_insert             = 1
let g:unite_source_file_mru_limit           = 100
let g:unite_enable_ignore_case              = 1
let g:unite_enable_smart_case               = 1

" Prefix-Key
nmap <Leader>a <SID>[unite]
nnoremap <SID>[unite] <Nop>

augroup UniteKeymap
    autocmd!
    au FileType unite nmap     <silent><buffer>  <ESC><ESC> <Plug>(unite_exit)
    au FileType unite imap     <silent><buffer>  <ESC><ESC> <Plug>(unite_exit)
    au FileType unite nmap     <silent><buffer>  a <Plug>(unite_append_end)
    au FileType unite imap     <buffer> <C-w>    <Plug>(unite_delete_backward_path)
    au FileType unite nnoremap <silent><buffer> <expr> <C-Enter> unite#do_action('vsplit')
    au FileType unite inoremap <silent><buffer> <expr> <C-Enter> unite#do_action('vsplit')
    au FileType unite setlocal tw=0
augroup END

nnoremap <silent> <SID>[unite]b :<C-u>Unite buffer<CR>
nnoremap <silent> <SID>[unite]f :<C-u>Unite file<CR>
nnoremap <silent> <SID>[unite]m :<C-u>Unite file_mru<CR>
nnoremap <silent> <SID>[unite]r :<C-u>Unite register<CR>
nnoremap <silent> <SID>[unite]/ :<C-u>Unite -buffer-name=search line<CR>
nnoremap <silent> <SID>[unite]: :<C-u>Unite command<CR>

" call  unite#custom#substitute('file,file_mru,history/command,directory_mru', '[[:alnum:]]', '*\0', 10)

" call  unite#custom#substitute('file,file_mru', '\$\w\+', '\=eval(submatch(0))', 20)
" call  unite#custom#substitute('file,file_mru', '[^~.]\zs/', '*/*', 20)
" call  unite#custom#substitute('file,file_mru', '/\ze[^*]', '/*', 10)
" call  unite#custom#substitute('file,file_mru', '^@@', '\=fnamemodify(expand("#"), ":p:h")."/*"', 2)
" call  unite#custom#substitute('file,file_mru', '^@', '\=getcwd()."/*"', 1)
" call  unite#custom#substitute('file,file_mru', '^;r', '\=$VIMRUNTIME."/"')
" call  unite#custom#substitute('file,file_mru', '^\~', escape($HOME, '\'), -2)
" call  unite#custom#substitute('file,file_mru', '^\\', escape($HOME, '\'), -2)
" call  unite#custom#substitute('file,file_mru', '\\\@<! ', '\\ ', -20)
" call  unite#custom#substitute('file,file_mru', '\\ \@!', '/', -30)
" }}}

" NERD Commenter{{{
let g:NERDCreateDefaultMappings = 0
let g:NERDSpaceDelims           = 1
nmap <Leader>c <Plug>NERDCommenterToggle
vmap <Leader>c <Plug>NERDCommenterToggle
" }}}

" alignta.vim{{{
let g:Align_xstrlen=3
vnoremap <Leader>a :Alignta<Space>
xmap <silent><expr> as mode() !=# 'v' ? ':Alignta \S\+'."\<CR>" : 'as'
" }}}

" memolist.vim {{{
let g:memolist_memo_suffix = 'txt'
let g:memolist_unite = 1
" }}}
"" ================================================================================
" vim: set tw=0 tabstop=4 shiftwidth=4  fdm=marker fdl=0 :
